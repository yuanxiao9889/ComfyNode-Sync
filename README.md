# ComfyNode Sync - ComfyUI 节点管理与迁移工具

ComfyNode Sync 是一个专为 ComfyUI 设计的节点管理和环境迁移工具。它提供了一个直观的图形界面，帮助用户轻松管理自定义节点（Custom Nodes），支持节点的更新、安装、修复以及在不同 ComfyUI 实例之间进行迁移。此外，它还提供了大模型和工作流的软链接共享功能，帮助用户节省磁盘空间并统一管理资源。

## 主要功能

### 1. 节点管理 (Node Management)
*   **可视化列表**：清晰展示当前已安装的节点列表，包括节点名称、类型（Git 仓库或普通文件夹）、远程地址和更新状态。
*   **一键更新**：支持批量检查更新和一键更新选中的 Git 节点。
*   **依赖安装**：支持为选中的节点一键安装 `requirements.txt` 中的依赖。
*   **节点修复**：支持一键修复（重新安装）出问题的节点。
*   **节点删除**：安全删除不需要的节点及其元数据。
*   **Git 安装**：支持通过输入 GitHub 地址直接安装新节点。
*   **快捷操作**：
    *   **右键菜单**：复制节点名称、复制 Git 地址、直接在浏览器打开 GitHub 仓库。
    *   **双击跳转**：双击节点直接跳转到 GitHub 页面（如果是普通文件夹则在 GitHub 搜索）。

### 2. 节点迁移 (Node Migration)
*   **旧环境扫描**：扫描指定的旧版 ComfyUI 节点目录。
*   **智能迁移**：
    *   **Git 节点**：自动识别 Git 仓库，通过 `git clone` 迁移，确保新环境中的节点干净且易于更新。
    *   **文件夹节点**：支持直接复制非 Git 管理的节点文件夹。
*   **状态过滤**：自动检测目标环境是否已存在同名节点，支持按状态（可迁移、已存在、已迁移）过滤列表。

### 3. 资源共享 (Resource Sharing)
*   **模型共享 (Symlink)**：通过创建软链接（Symlink），将大模型文件夹（如 `models`）链接到新的 ComfyUI 实例，无需复制庞大的文件，节省大量磁盘空间。
*   **工作流共享**：支持将工作流文件夹链接到新实例，方便统一管理和复用工作流。

### 4. 系统日志与设置
*   **实时日志**：右侧侧边栏实时显示操作日志，方便排查问题。
*   **代理设置**：支持设置 HTTP 代理，加速 Git 克隆和更新操作。
*   **Python 环境自动检测**：自动检测 ComfyUI 内置的 Python 环境。

## 使用说明

### 运行环境
*   Windows 操作系统
*   Python 3.x (推荐使用 ComfyUI 自带的嵌入式 Python)

### 安装与启动
1.  克隆或下载本项目到本地。
2.  确保已安装必要的依赖库（如果使用 ComfyUI 的 Python，通常已包含大部分标准库，额外依赖需安装 `ttkbootstrap`, `gitpython` 等）。
    ```bash
    pip install -r requirements.txt
    ```
3.  运行 `start.bat` (如果已配置好) 或直接运行 `gui.py`：
    ```bash
    python gui.py
    ```

### 界面操作
1.  **设置路径**：
    *   首次运行请先在左上角设置 **ComfyUI 根目录**。程序会自动推断 `custom_nodes` 和 Python 解释器的路径。
    *   如果需要使用代理，请在“代理端口”处输入端口号（如 `7890`）。
2.  **节点管理**：
    *   切换到“节点管理”标签页。
    *   点击“刷新列表”加载当前节点。
    *   使用复选框选择节点，然后点击工具栏按钮执行更新、修复或删除操作。
3.  **节点迁移**：
    *   切换到“节点迁移”标签页。
    *   设置“旧版节点路径”，点击“扫描旧节点”。
    *   选择需要迁移的节点，点击“迁移选中节点”（推荐）或“直接复制选中”。
4.  **资源共享**：
    *   切换到“资源共享”标签页。
    *   设置源路径（如您的大模型存储目录）和目标路径（新 ComfyUI 的对应目录）。
    *   点击“创建模型软链”或“创建工作流软链”。**注意：此操作可能会删除目标位置原有的空文件夹，请谨慎操作并查看提示。**

## 注意事项
*   创建软链接可能需要管理员权限。如果遇到权限错误，请尝试以管理员身份运行程序或按提示操作。
*   在执行删除或覆盖操作前，建议备份重要数据。

## License
MIT License
